@page "/report/product-invoice/{productId}"
@inject IJSRuntime Js

<div class="container-fluid">
    <div class="row d-print-none">
        <div class="card card-body">
            <h3>
                Review/Edit Report
            </h3>
            <label for="sku" class="form-label">Font size test</label>
            <input type="number" class="form-control" id="sku" placeholder="SKU" @bind="@FontTitleSize">
            <div class="col-md-2 m-2">
                <button type="button" class="btn btn-primary d-print-none text-right" @onclick="Print">Customize report</button>
            </div>
            <div class="col-md-2 m-2">
                <button type="button" class="btn btn-primary d-print-none text-right" @onclick="Print">Export Pdf</button>
            </div>
            <div class="col-md-2 m-2">
                <button type="button" class="btn btn-primary d-print-none text-right" @onclick="PrintWord">Export Word (.docx)</button>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="report" id="reportContent">
            <h1>Report</h1>
            <div class="info">
                <p><strong>Invoice Number:</strong> INV-123456</p>
                <p><strong>Date:</strong> March 28, 2024</p>
                <p><strong>Due Date:</strong> April 10, 2024</p>
                <p><strong>Customer:</strong> John Doe</p>
                <p><strong>Email:</strong> john@example.com</p>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>Quantity</th>
                        <th>Unit Price</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Product A</td>
                        <td>2</td>
                        <td>$50.00</td>
                        <td>$100.00</td>
                    </tr>
                    <tr>
                        <td>Product B</td>
                        <td>1</td>
                        <td>$80.00</td>
                        <td>$80.00</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3">Subtotal</td>
                        <td>$180.00</td>
                    </tr>
                    <tr>
                        <td colspan="3">Tax (10%)</td>
                        <td>$18.00</td>
                    </tr>
                    <tr>
                        <td colspan="3">Total</td>
                        <td>$198.00</td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>
<style>
    .report {
        max-width: 800px;
        margin: 0 auto;
        border: 1px solid #212529;
        padding: 20px;
        border-radius: 5px;
    }

        .report h1 {
            font-size: @(FontTitleSize)px;
            text-align: center;
        }

        .report .info {
            margin-bottom: 20px;
        }

            .report .info p {
                margin: 5px 0;
            }

        .report table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .report th, .report td {
            border: 1px solid #212529;
            padding: 8px;
            text-align: left;
        }

        .report tfoot {
            font-weight: bold;
        }
</style>
@code 
{
    [Parameter]
    public string productId { get; set; }

    private async Task Print()
    {
        await Js.InvokeVoidAsync("window.print");
    }

    private async Task PrintWord()
    {
        await Js.InvokeVoidAsync("exportWord");
    }
}

@code
{
    public int FontTitleSize = 12;
}